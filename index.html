{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 Helvetica;}
{\colortbl;\red255\green255\blue255;}
{\*\expandedcolortbl;;}
\margl1440\margr1440\vieww11520\viewh8400\viewkind0
\pard\tx720\tx1440\tx2160\tx2880\tx3600\tx4320\tx5040\tx5760\tx6480\tx7200\tx7920\tx8640\pardirnatural\partightenfactor0

\f0\fs24 \cf0 <!DOCTYPE html>\
<html lang="en">\
<head>\
    <meta charset="UTF-8">\
    <meta name="viewport" content="width=device-width, initial-scale=1.0">\
    <title>Marine Species Verification Tool</title>\
    <style>\
        .marine-tool \{\
            max-width: 800px;\
            margin: 20px auto;\
            padding: 20px;\
            font-family: Arial, sans-serif;\
            background: white;\
            border-radius: 10px;\
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);\
        \}\
        \
        .tool-header \{\
            text-align: center;\
            margin-bottom: 30px;\
        \}\
        \
        .tool-header h1 \{\
            color: #09306b;\
            margin-bottom: 10px;\
        \}\
        \
        .tool-header p \{\
            color: #666;\
            font-size: 18px;\
        \}\
        \
        .upload-area \{\
            border: 3px dashed #ddd;\
            border-radius: 10px;\
            padding: 40px;\
            text-align: center;\
            margin-bottom: 30px;\
            background: #f9f9f9;\
        \}\
        \
        .upload-btn \{\
            background: linear-gradient(135deg, #209e5d, #1976d2);\
            color: white;\
            border: none;\
            padding: 15px 30px;\
            border-radius: 8px;\
            font-size: 18px;\
            cursor: pointer;\
            transition: transform 0.3s ease;\
        \}\
        \
        .upload-btn:hover \{\
            transform: translateY(-2px);\
        \}\
        \
        .file-input \{\
            display: none;\
        \}\
        \
        .status-message \{\
            padding: 15px;\
            border-radius: 8px;\
            margin: 20px 0;\
            text-align: center;\
            font-weight: bold;\
        \}\
        \
        .status-info \{\
            background: #d1ecf1;\
            color: #0c5460;\
            border: 1px solid #bee5eb;\
        \}\
        \
        .status-success \{\
            background: #d4edda;\
            color: #155724;\
            border: 1px solid #c3e6cb;\
        \}\
        \
        .status-error \{\
            background: #f8d7da;\
            color: #721c24;\
            border: 1px solid #f5c6cb;\
        \}\
        \
        .results-area \{\
            display: none;\
            margin-top: 30px;\
        \}\
        \
        .species-card \{\
            background: white;\
            border: 2px solid #e9ecef;\
            border-radius: 8px;\
            padding: 20px;\
            margin: 15px 0;\
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);\
        \}\
        \
        .species-name \{\
            font-style: italic;\
            font-size: 20px;\
            font-weight: bold;\
            color: #333;\
            margin-bottom: 10px;\
        \}\
        \
        .species-status \{\
            padding: 5px 12px;\
            border-radius: 15px;\
            font-size: 12px;\
            font-weight: bold;\
            text-transform: uppercase;\
            display: inline-block;\
            margin-bottom: 10px;\
        \}\
        \
        .status-verified \{\
            background: #28a745;\
            color: white;\
        \}\
        \
        .status-not-found \{\
            background: #dc3545;\
            color: white;\
        \}\
        \
        .confidence-bar \{\
            width: 100%;\
            height: 8px;\
            background: #e9ecef;\
            border-radius: 4px;\
            overflow: hidden;\
            margin-top: 10px;\
        \}\
        \
        .confidence-fill \{\
            height: 100%;\
            background: linear-gradient(90deg, #28a745, #20c997);\
            transition: width 0.3s ease;\
        \}\
        \
        .loading \{\
            text-align: center;\
            padding: 40px;\
        \}\
        \
        .spinner \{\
            border: 4px solid #f3f3f3;\
            border-top: 4px solid #2196f3;\
            border-radius: 50%;\
            width: 50px;\
            height: 50px;\
            animation: spin 1s linear infinite;\
            margin: 0 auto 20px;\
        \}\
        \
        @keyframes spin \{\
            0% \{ transform: rotate(0deg); \}\
            100% \{ transform: rotate(360deg); \}\
        \}\
    </style>\
</head>\
<body>\
    <div class="marine-tool">\
        <div class="tool-header">\
            <h1>\uc0\u55357 \u56346  Marine Species Verification Tool</h1>\
            <p>Upload field guides \'95 Extract species data \'95 Verify with marine databases</p>\
        </div>\
        \
        <div class="upload-area" id="uploadArea">\
            <h3>Upload Marine Field Guide PDF</h3>\
            <p>Click to select your PDF file for species verification</p>\
            <button class="upload-btn" onclick="document.getElementById('fileInput').click()">\
                Choose PDF File\
            </button>\
            <input type="file" id="fileInput" class="file-input" accept=".pdf" onchange="handleFileUpload(event)">\
        </div>\
        \
        <div id="statusArea"></div>\
        <div id="resultsArea" class="results-area"></div>\
    </div>\
\
    <script>\
        // Simplified configuration for Squarespace\
        const CONFIG = \{\
            GOOGLE_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbxBhPVDmQhqgLRHNW13XmeYgWqSexHKon3J1bEXAzt4wzPlDcYNozoV2i9ON7ul7hq3/exec'\
        \};\
\
        function showStatus(message, type = 'info') \{\
            const statusArea = document.getElementById('statusArea');\
            statusArea.innerHTML = `<div class="status-message status-$\{type\}">$\{message\}</div>`;\
        \}\
\
        function showLoading(message) \{\
            const statusArea = document.getElementById('statusArea');\
            statusArea.innerHTML = `\
                <div class="loading">\
                    <div class="spinner"></div>\
                    <div class="status-message status-info">$\{message\}</div>\
                </div>\
            `;\
        \}\
\
        async function handleFileUpload(event) \{\
            const file = event.target.files[0];\
            if (!file) return;\
\
            if (file.size > 50 * 1024 * 1024) \{\
                showStatus('File too large. Maximum size is 50MB', 'error');\
                return;\
            \}\
\
            if (file.type !== 'application/pdf') \{\
                showStatus('Please upload a PDF file only.', 'error');\
                return;\
            \}\
\
            try \{\
                showLoading('Processing your PDF...');\
                \
                // Simple form submission approach for Squarespace compatibility\
                const formData = new FormData();\
                formData.append('file', file);\
                formData.append('action', 'upload');\
\
                // Use a more compatible fetch approach\
                const response = await window.fetch(CONFIG.GOOGLE_SCRIPT_URL, \{\
                    method: 'POST',\
                    body: formData\
                \});\
\
                if (!response.ok) \{\
                    throw new Error(`Server error: $\{response.status\}`);\
                \}\
\
                const result = await response.json();\
                \
                if (result.error) \{\
                    throw new Error(result.error);\
                \}\
\
                showStatus('\uc0\u9989  PDF processed successfully!', 'success');\
                displaySimpleResults(result);\
\
            \} catch (error) \{\
                console.error('Processing error:', error);\
                showStatus(`\uc0\u10060  Processing failed: $\{error.message\}`, 'error');\
            \}\
        \}\
\
        function displaySimpleResults(data) \{\
            const resultsArea = document.getElementById('resultsArea');\
            \
            // Simple results display\
            resultsArea.innerHTML = `\
                <h3>\uc0\u55357 \u56522  Processing Results</h3>\
                <div class="species-card">\
                    <div class="species-name">Processing Complete</div>\
                    <p>Your PDF has been uploaded and is being processed.</p>\
                    <p><strong>File ID:</strong> $\{data.fileId || 'Generated'\}</p>\
                    <p><strong>Status:</strong> Successfully uploaded to Google Drive</p>\
                </div>\
            `;\
            \
            resultsArea.style.display = 'block';\
        \}\
\
        // Squarespace-compatible initialization\
        document.addEventListener('DOMContentLoaded', function() \{\
            console.log('Marine Species Tool initialized');\
        \});\
    </script>\
</body>\
</html>}